# Standalone Pipeline to run Automated E2E tests on demand
# Using rsp-iras-qa repo

name: Run Playwright Tests

trigger:
  - main

schedules:
  - cron: '0 0 * * Mon-Fri'
    displayName: 'Nightly run - full suite'
    branches:
      include: 
      - main
    always: true

pool:
  vmImage: "Ubuntu-latest"

parameters:
  - name: browser
    displayName: Select a Browser
    type: string
    default: chromium
    values:
      - chromium
      - safari
      - firefox
  - name: devops_library_branch
    displayName: DevOps Library Branch
    type: string
    default: main
  - name: tests_run_timeout
    type: number
    displayName: Playwright Tests Run Timeout
    default: 10
    
variables:
  - group: 'Test Automation'

resources:
  repositories:
    - repository: library
      type: git
      name: DevOps/rsp-azure-devops-library
      ref: ${{ parameters.devops_library_branch }}

stages:
  - stage: E2EPlaywrightTests
    displayName: E2E Playwright Tests
    jobs:
      - template: jobs/e2e_tests.yaml@library
        parameters:
          browser: ${{ parameters.browser }}
          upload_to_sharepoint: true
          tests_run_timeout: ${{ parameters.tests_run_timeout }}
